(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{18:function(e,t,n){e.exports=n(27)},23:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(13),s=n.n(i),c=(n(23),n(4)),o=n(5);function u(){var e=Object(c.a)(["\n  height: 80px;\n  margin-right: 10px;\n"]);return u=function(){return e},e}function l(){var e=Object(c.a)(["\n  display: inline-flex;\n  align-items: center;\n  padding: 10px 20px 10px 10px;\n  font-size: 45px;\n  background-color: #7289da;\n  border-radius: 5px;\n  color: #fff;\n  cursor: pointer;\n"]);return l=function(){return e},e}o.a.a(l()),o.a.img(u());var d=n(1),p=n.n(d),m=n(2),f=n(3),v=n(6),h=n(7),b=n(8),g=n(17);function E(){var e=Object(c.a)(["\n  pointerevents: ",";\n  "," {\n    opacity: ",";\n  }\n"]);return E=function(){return e},e}function w(){var e=Object(c.a)(["\n  cursor: pointer;\n  padding: 10px;\n  border-bottom: 1px solid #eee;\n  &:hover {\n    background-color: #eee;\n  }\n"]);return w=function(){return e},e}var x,y=function(e){Object(b.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onChangeDebounced=Object(g.debounce)(e.props.onChangeDebounced,300),e}return Object(v.a)(n,[{key:"render",value:function(){var e=this;return a.a.createElement("input",Object.assign({},this.props,{onChange:function(t){t.persist(),e.props.onChange&&e.props.onChange(t),e.onChangeDebounced(t)}}))}}]),n}(a.a.Component),O=function(e){Object(b.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={disabled:!1,searching:!1,currentResults:[],searchText:""},e.wrapperRef=void 0,e.setWrapperRef=function(t){e.wrapperRef=t},e.handleClickOutside=function(t){e.wrapperRef&&!e.wrapperRef.contains(t.target)&&(e.reset(),e.props.itemProvider.abort())},e.onChange=function(t){e.search(t.target.value)},e.search=function(){var t=Object(m.a)(p.a.mark((function t(n){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.props.itemProvider.abort(),!(n.length<3)){t.next=4;break}return e.setState({searching:!1,disabled:!1,currentResults:[]}),t.abrupt("return");case 4:return e.setState({searching:!0}),t.prev=5,t.t0=e,t.next=9,e.props.itemProvider.getItems(n);case 9:t.t1=t.sent,t.t2={currentResults:t.t1},t.t0.setState.call(t.t0,t.t2);case 12:return t.prev=12,e.setState({searching:!1,disabled:!1}),t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[5,,12,15]])})));return function(e){return t.apply(this,arguments)}}(),e.reset=function(){e.setState({currentResults:[],searchText:""})},e}return Object(v.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{ref:this.setWrapperRef,className:"item-selector"},a.a.createElement(y,{value:this.state.searchText,className:"auto-suggest big",placeholder:"Search for items...",onChange:function(t){e.setState({disabled:!0,searchText:t.target.value})},onChangeDebounced:this.onChange}),this.state.currentResults.length>0&&a.a.createElement(C,{disabled:this.state.disabled,items:this.state.currentResults,onClick:function(t){e.props.onItemSelected(t),e.props.resetOnSelection&&e.reset()}}))}}]),n}(a.a.Component),S=o.a.div(w()),k=o.a.div(E(),(function(e){return e.disabled?"none":"inherit"}),S,(function(e){return e.disabled?.5:1})),C=function(e){return a.a.createElement(k,{className:"result-wrap",disabled:e.disabled},e.items.map((function(t){return a.a.createElement(S,{className:"result",onClick:function(){return e.onClick(t)}},a.a.createElement("div",{className:"name"},t.name),a.a.createElement("div",{className:"type"},t.type),a.a.createElement("div",{className:"slot"},t.slot))})))},N=function(e){return a.a.createElement("div",{className:"item-row"},a.a.createElement("div",{className:"name"},e.item.name),a.a.createElement("div",{className:"type"},e.item.type),a.a.createElement("div",{className:"item-action"},a.a.createElement("div",{className:"button delete",onClick:e.onDelete},"delete")))};!function(e){e.MC="MC",e.BWL="BWL",e.ZG="ZG",e.ONY="ONY"}(x||(x={}));var j,B=function e(t){var n=this;Object(f.a)(this,e),this.api=void 0,this.getItems=function(){var e=Object(m.a)(p.a.mark((function e(t){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.api.searchItems(t);case 2:return r=e.sent,e.abrupt("return",r.results);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.abort=function(){},this.api=t},R=a.a.createContext(new function e(t){var n=this;Object(f.a)(this,e),this.apiRoot=void 0,this.getPriority=Object(m.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(n.apiRoot,"priorities/"),{redirect:"follow",mode:"cors",credentials:"include"});case 2:if(200===(t=e.sent).status){e.next=5;break}throw new Error("Error getting priority");case 5:return e.next=7,t.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)}))),this.updatePriority=function(){var e=Object(m.a)(p.a.mark((function e(t){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(n.apiRoot,"priorities/bulk_update/"),{method:"POST",headers:{"Content-Type":"application/json"},redirect:"follow",mode:"cors",credentials:"include",body:JSON.stringify({items:t})});case 2:if(400!=(r=e.sent).status){e.next=9;break}return e.t0=Error,e.next=7,r.json();case 7:throw e.t1=e.sent.non_field_errors,new e.t0(e.t1);case 9:if(201===r.status){e.next=11;break}throw new Error("generic error updating priority");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.searchItems=function(){var e=Object(m.a)(p.a.mark((function e(t){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(n.apiRoot,"items/?search=").concat(t),{redirect:"follow",mode:"cors",credentials:"include"});case 2:if(200===(r=e.sent).status){e.next=5;break}throw new Error("Error getting items");case 5:return e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.apiRoot=t}("/api/v1/")),T={rule:"Up to 3 items from Molten Core or Onyxia",isValid:function(e){return e.filter((function(e){return e.zone==x.MC||e.zone==x.ONY})).length<=3}},P={rule:"Up to 3 items from Blackwing Lair",isValid:function(e){return e.filter((function(e){return e.zone==x.BWL})).length<=3}},M={rule:"Optional: Fill remaining slots with other raids",isValid:function(e){return!0}},L=function(e){var t=e.validator.isValid(e.items);return a.a.createElement("span",{className:t?void 0:"invalid"},e.validator.rule)},I=function(e){var t,n,i,s=(t=e.selected,n="zone",t.reduce((function(e,t){var r=t[n];return e[r]=e[r]||[],e[r].push(t),e}),{})),c=Object(r.useContext)(R),o=[(i=6,{rule:"Up to ".concat(i," items total"),isValid:function(e){return e.length<=i}}),T,P,M];return a.a.createElement("div",{className:"selected-items"},a.a.createElement("div",{className:"selected-items-instructions"},a.a.createElement("span",null,"Priority list rules:"),a.a.createElement("ul",null,o.map((function(t){return a.a.createElement("li",null,a.a.createElement(L,{validator:t,items:e.selected}))})))),a.a.createElement(O,{resetOnSelection:!0,itemProvider:new B(c),onItemSelected:function(t){e.selected.find((function(e){return e.id==t.id}))||e.onAddNew(t,o.reduce((function(n,r){return n&&r.isValid(e.selected.concat(t))}),!0))}}),Object.keys(s).map((function(t){return a.a.createElement("div",{className:"zone"},a.a.createElement("h2",null,function(e){switch(e){case x.BWL:return"Blackwing Lair";case x.MC:return"Molten Core";case x.ONY:return"Onyxia";case x.ZG:return"Zul'gurub"}return e}(t)),s[t].map((function(t){return a.a.createElement(N,{item:t,onDelete:function(){var n=e.selected.filter((function(e){return e.id!=t.id})),r=o.reduce((function(e,t){return e&&t.isValid(n)}),!0);e.onChangeSelection(n,r)}})})))})))},D=function(){return a.a.createElement("div",{className:"header"},a.a.createElement("div",null,a.a.createElement("div",{className:"wordmark"},"Mischief@Pagle")))},F=function(){var e=Object(r.useContext)(R);return a.a.createElement(G,{api:e})};!function(e){e[e.None=0]="None",e[e.Fetching=1]="Fetching",e[e.Success=2]="Success",e[e.Error=3]="Error"}(j||(j={}));var G=function(e){Object(b.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={setupState:j.None,priority:[],saveEnabled:!1,saveButtonText:"Save Changes"},e.feelGood=null,e.setup=Object(m.a)(p.a.mark((function t(){var n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({setupState:j.Fetching}),n=e.props.api,t.prev=2,t.next=5,n.getPriority();case 5:r=t.sent,e.setState({priority:r.results.map((function(e){return e.item})),setupState:j.Success}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),e.setState({setupState:j.Error});case 12:case"end":return t.stop()}}),t,null,[[2,9]])}))),e.isFetching=function(){return e.state.setupState==j.Fetching},e.isError=function(){return e.state.setupState==j.Error},e.isSuccess=function(){return e.state.setupState==j.Success},e.addNewItem=function(t,n){e.state.priority.find((function(e){return e.id==t.id}))||e.setState({priority:e.state.priority.concat(t),saveEnabled:n})},e.saveButtonTimeout=void 0,e.setSaveButton=function(t){clearTimeout(e.saveButtonTimeout),e.setState({saveButtonText:t}),e.saveButtonTimeout=setTimeout((function(){e.setState({saveButtonText:"Save Changes"})}),3e3)},e.save=Object(m.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.state.saveEnabled){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,e.props.api.updatePriority(e.state.priority.map((function(e){return e.id})));case 5:e.setSaveButton("Save Successful!"),e.feelGood&&(e.feelGood.classList.add("feel-good-animate"),setTimeout((function(){e.feelGood.classList.remove("feel-good-animate")}),4e3)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),e.setSaveButton("Error Saving: "+t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[2,9]])}))),e}return Object(v.a)(n,[{key:"componentDidMount",value:function(){this.setup()}},{key:"render",value:function(){var e=this;return a.a.createElement("div",null,a.a.createElement("h1",null,"Priority Management"),this.isFetching()&&a.a.createElement("div",null,"Fetching priority..."),this.isError()&&a.a.createElement("div",null,"Error getting priority items. Try to refresh the page."),this.isSuccess()&&a.a.createElement("div",{className:"selected-item-wrap"},a.a.createElement(I,{max:6,selected:this.state.priority,onAddNew:this.addNewItem,onChangeSelection:function(t,n){return e.setState({priority:t,saveEnabled:n})}}),a.a.createElement("div",{className:"spacer"}),a.a.createElement("div",{className:"button save-prio big centered "+(this.state.saveEnabled?"":"disabled"),onClick:this.save},this.state.saveButtonText)),a.a.createElement("div",{ref:function(t){return e.feelGood=t},className:"feels-good"}))}}]),n}(a.a.Component);var V=function(){return a.a.createElement("div",null,a.a.createElement(D,null),a.a.createElement("div",{className:"page-wrap"},a.a.createElement(F,null)))};console.log("/api/v1/"),s.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(V,null)),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.e9520a4e.chunk.js.map